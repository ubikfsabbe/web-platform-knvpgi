"use strict";(self.webpackChunkmaquettage_dot=self.webpackChunkmaquettage_dot||[]).push([[390],{8390:(st,y,s)=>{s.r(y),s.d(y,{ActivityModule:()=>ct});var I=s(4466),T=s(1819),L=s(1566),b=s(4482),M=s(5403);function A(n,a=L.z){return(0,b.e)((e,o)=>{let c=null,i=null,r=null;const d=()=>{if(c){c.unsubscribe(),c=null;const p=i;i=null,o.next(p)}};function v(){const p=r+n,g=a.now();if(g<p)return c=this.schedule(void 0,p-g),void o.add(c);d()}e.subscribe((0,M.x)(o,p=>{i=p,r=a.now(),c||(c=a.schedule(v,n),o.add(c))},()=>{d(),o.complete()},void 0,()=>{i=c=null}))})}var x=s(1884),_=s(4004),u=s(7044),t=s(1571),l=s(6895),Z=s(2392),m=s(433);function D(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.collaborator.login," "),t.xp6(2),t.hij(" ",e.start," "),t.xp6(2),t.hij(" ",e.end," "),t.xp6(2),t.hij(" ",e.rate," ")}}let J=(()=>{class n{constructor(){this.term="",this._attachments=[],this.searchProject=e=>e.pipe(A(200),(0,x.x)(),(0,_.U)(o=>o.length<2?[]:this.findProjects(o).map(c=>c.name)))}get attachments(){return this._attachments}updateAttachments(){const e=this.findProjects(this.term);this._attachments=u.wr.filter(o=>o.project===e[0])}findProjects(e){return u.Fw.filter(o=>o.name.toLowerCase().indexOf(e.trim().toLowerCase())>-1).slice(0,10)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attachments"]],decls:16,vars:3,consts:[["for","typeahead-basic"],["id","typeahead-basic","type","text",1,"form-control",3,"ngModel","ngbTypeahead","ngModelChange"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.TgZ(0,"label",0),t._uU(1,"Rechercher un projet:"),t.qZA(),t.TgZ(2,"input",1),t.NdJ("ngModelChange",function(i){return o.term=i})("ngModelChange",function(){return o.updateAttachments()}),t.qZA(),t.TgZ(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),t._uU(7,"Login"),t.qZA(),t.TgZ(8,"th",3),t._uU(9,"D\xe9but"),t.qZA(),t.TgZ(10,"th",3),t._uU(11,"Fin"),t.qZA(),t.TgZ(12,"th",3),t._uU(13,"Taux"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,D,9,4,"tr",4),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngModel",o.term)("ngbTypeahead",o.searchProject),t.xp6(13),t.Q6J("ngForOf",o.attachments))},dependencies:[l.sg,Z.dR,m.Fj,m.JJ,m.On]}),n})();var j=s(590),O=s(8746),h=s(5355),E=s(2632),U=s(3617),f=s(7564);const R=new Map([[f.cS.RecordEnum.Quarter,"1/4"],[f.cS.RecordEnum.Half,"1/2"],[f.cS.RecordEnum.ThreeQuarters,"3/4"],[f.cS.RecordEnum.Full,"1"]]);let q=(()=>{class n{transform(e,...o){return e?R.get(e):""}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"activityRecord",type:n,pure:!0}),n})();const F=function(n){return{"bg-secondary":n}};function N(n,a){if(1&n&&(t.TgZ(0,"th",5),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=a.$implicit;t.Q6J("ngClass",t.VKq(5,F,e.isNonWorkingDay)),t.xp6(1),t.hij(" ",t.xi3(2,2,e.date,"EEEEEE d")," ")}}function w(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"app-loading"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.infos.length+1)}}function P(n,a){if(1&n&&(t.TgZ(0,"td",9),t._uU(1),t.ALo(2,"activityRecord"),t.qZA()),2&n){const e=a.$implicit,o=t.oxw().$implicit;t.Q6J("ngClass",t.VKq(4,F,e.isNonWorkingDay)),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.records.get(o))," ")}}function Q(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"th",7),t._uU(2),t.qZA(),t.YNc(3,P,3,6,"td",8),t.qZA()),2&n){const e=a.$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngForOf",o.infos)}}function S(n,a){if(1&n&&t.YNc(0,Q,4,2,"tr",6),2&n){const e=t.oxw();t.Q6J("ngForOf",e.projects)}}const Y=[h.c.RecordEnum.Full,h.c.RecordEnum.Half,h.c.RecordEnum.Quarter,h.c.RecordEnum.ThreeQuarters];let $=(()=>{class n{constructor(e){this.projectService=e,this._loading=!1,this._infos=[],this._projects=[];const o=new Date;this._month=o.getMonth(),this._year=o.getFullYear(),this.refreshProjects(),this.refreshInfos()}get loading(){return this._loading}get month(){return this._month}get year(){return this._year}get infos(){return this._infos}get projects(){return this._projects}refreshInfos(){this._infos=[],new Date(this._year,this._month,1);const c=new Date(this._year,this._month+1,0).getDate(),i=new Date("2023-05-18T00:00:00");for(let r=1;r<=c;r++){const d=new Date(this._year,this._month,r),v=d.getDay(),p=d.getTime()===i.getTime(),g=0===v||6===v;this._infos.push({date:d,records:new Map(p||g?[]:[[u.q_,this.generateRecord(d)]]),isPublicHolyday:p,isNonWorkingDay:g})}}generateRecord(e){const c=e.getDate()%4;return Y[c]}refreshProjects(){const e=new Date(this._year,this._month,1),o=new Date(this._year,this._month+1,0);this._loading=!0,this.projectService.getProjects(u.VI,{start:e,end:o}).pipe((0,j.P)(),(0,O.x)(()=>this._loading=!1)).subscribe(c=>this._projects=c)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(E.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-input"]],decls:10,vars:3,consts:[[1,"table","table-condensed"],["scope","col"],["scope","col",3,"ngClass",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["infosView",""],["scope","col",3,"ngClass"],[4,"ngFor","ngForOf"],["scope","row"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(e,o){if(1&e&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),t._uU(4,"Projet"),t.qZA(),t.YNc(5,N,3,7,"th",2),t.qZA()(),t.TgZ(6,"tbody"),t.YNc(7,w,3,1,"tr",3),t.YNc(8,S,1,1,"ng-template",null,4,t.W1O),t.qZA()()),2&e){const c=t.MAs(9);t.xp6(5),t.Q6J("ngForOf",o.infos),t.xp6(2),t.Q6J("ngIf",o.loading)("ngIfElse",c)}},dependencies:[l.mk,l.sg,l.O5,U.N,l.uU,q],styles:[".table-condensed[_ngcontent-%COMP%]{font-size:smaller}"]}),n})();var C=s(2687),V=s(2887),W=s(9646),z=s(1005);let B=(()=>{class n{constructor(){}getLeaves(e){return(0,W.of)(u.ZU).pipe((0,z.g)(500),(0,_.U)(o=>o.filter(c=>c.collaborator===e)))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var H=s(2216);function K(n,a){1&n&&(t.TgZ(0,"tr")(1,"td",8),t._UZ(2,"app-loading"),t.qZA()())}function X(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",10)(6,"fa-icon",11),t.NdJ("click",function(){const i=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.editLeave(i))}),t.qZA(),t.TgZ(7,"fa-icon",11),t.NdJ("click",function(){const i=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.deleteLeave(i))}),t.qZA()()()}if(2&n){const e=a.$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",e.start," "),t.xp6(2),t.hij(" ",e.end," "),t.xp6(2),t.Q6J("icon",o.editIcon),t.xp6(1),t.Q6J("icon",o.deleteIcon)}}function G(n,a){if(1&n&&t.YNc(0,X,8,4,"tr",9),2&n){const e=t.oxw();t.Q6J("ngForOf",e.leaves)}}function tt(n,a){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"percent"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e)," ")}}function et(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.YNc(3,tt,3,3,"td",6),t.qZA()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngForOf",e.amounts)}}const nt=[{name:"Projet 1",amounts:[1,1,.5,0]},{name:"Projet 2",amounts:[0,0,0,1]},{name:"Disponibilit\xe9",amounts:[0,0,.5,0]}],ot=[{path:"attachments",component:J},{path:"leaves",component:(()=>{class n{constructor(e,o){this.leaveService=e,this.modalService=o,this.addIcon=C.r8p,this.deleteIcon=C.$aW,this.editIcon=C.Yai,this._leaves=[],this._loading=!1}ngOnInit(){this.refreshLeaves()}get leaves(){return this._leaves}get loading(){return this._loading}addLeave(){}deleteLeave(e){this.modalService.open(V.$,{backdrop:"static"}).componentInstance.message="\xcates-vous s\xfbr de vouloir supprimer ce cong\xe9s ?"}editLeave(e){}refreshLeaves(){this._loading=!0,this.leaveService.getLeaves(u.VI).pipe((0,j.P)(),(0,O.x)(()=>this._loading=!1)).subscribe(e=>this._leaves=e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(B),t.Y36(Z.FF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-leaves"]],decls:19,vars:3,consts:[[1,"d-flex","flex-row","justify-content-between"],[1,"btn","btn-primary",3,"click"],[3,"icon"],[1,"table","table-striped"],["scope","col"],["scope","col",1,"text-end"],[4,"ngIf","ngIfElse"],["leavesView",""],["colspan","3"],[4,"ngFor","ngForOf"],[1,"text-end"],[1,"btn",3,"icon","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"h4"),t._uU(2,"Cong\xe9s"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return o.addLeave()}),t._UZ(4,"fa-icon",2),t._uU(5," Ajouter un cong\xe9s "),t.qZA()(),t.TgZ(6,"table",3)(7,"thead")(8,"tr")(9,"th",4),t._uU(10,"D\xe9but"),t.qZA(),t.TgZ(11,"th",4),t._uU(12,"Fin"),t.qZA(),t.TgZ(13,"th",5),t._uU(14,"Actions"),t.qZA()()(),t.TgZ(15,"tbody"),t.YNc(16,K,3,0,"tr",6),t.YNc(17,G,1,1,"ng-template",null,7,t.W1O),t.qZA()()),2&e){const c=t.MAs(18);t.xp6(4),t.Q6J("icon",o.addIcon),t.xp6(12),t.Q6J("ngIf",o.loading)("ngIfElse",c)}},dependencies:[l.sg,l.O5,H.BN,U.N]}),n})()},{path:"occupancies",component:(()=>{class n{constructor(){this._occupancies=[],this.term="",this.searchCollaborator=e=>e.pipe(A(200),(0,x.x)(),(0,_.U)(o=>o.length<2?[]:this.findCollaborators(o).map(c=>c.login)))}get occupancies(){return this._occupancies}updateOccupancies(){const e=this.findCollaborators(this.term);e.length>0&&(this._occupancies=e.length?nt:[])}findCollaborators(e){return u.vt.filter(o=>o.login.toLowerCase().indexOf(e.trim().toLowerCase())>-1).slice(0,10)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-occupation"]],decls:21,vars:3,consts:[["for","typeahead-basic"],["id","typeahead-basic","type","text",1,"form-control",3,"ngModel","ngbTypeahead","ngModelChange"],[1,"table","table-striped"],["scope","col","rowspan","2"],["scope","col","colspan","4",1,"text-center"],["scope","col"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.TgZ(0,"label",0),t._uU(1,"Rechercher un collaborateur:"),t.qZA(),t.TgZ(2,"input",1),t.NdJ("ngModelChange",function(i){return o.term=i})("ngModelChange",function(){return o.updateOccupancies()}),t.qZA(),t.TgZ(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),t._uU(7,"Projet"),t.qZA(),t.TgZ(8,"th",4),t._uU(9,"Occupation"),t.qZA()(),t.TgZ(10,"tr")(11,"th",5),t._uU(12,"Du 27/02/2023 au 02/03/2023"),t.qZA(),t.TgZ(13,"th",5),t._uU(14,"Du 03/03/2023 au 09/03/2023"),t.qZA(),t.TgZ(15,"th",5),t._uU(16,"Du 10/03/2023 au 16/03/2023"),t.qZA(),t.TgZ(17,"th",5),t._uU(18,"Du 17/03/2023 au 23/03/2023"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,et,4,2,"tr",6),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngModel",o.term)("ngbTypeahead",o.searchCollaborator),t.xp6(18),t.Q6J("ngForOf",o.occupancies))},dependencies:[l.sg,Z.dR,m.Fj,m.JJ,m.On,l.Zx]}),n})()},{path:"input",component:$}];let at=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[T.Bz.forChild(ot),T.Bz]}),n})(),ct=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[I.m,at]}),n})()}}]);